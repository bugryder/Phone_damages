<!--
Author: Chao-Hsuan Ke
Last update: January 18, 2017 09:56 PM
Web
License: Creative Commons Attribution 3.0 Unported
License URL: http://creativecommons.org/licenses/by/3.0/
-->
<!DOCTYPE html>
<html>
<head>
	<title>Phone damages calculator (Mobile)</title>
	<link href="css/style.css" rel='stylesheet' type='text/css'/>
	<link href='//fonts.googleapis.com/css?family=Open+Sans:400,300italic,300,400italic,600,600italic,700,700italic,800,800italic' rel='stylesheet' type='text/css'>
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />		
		<script type="application/x-javascript"> addEventListener("load", function() { setTimeout(hideURLbar, 0); }, false); function hideURLbar(){ window.scrollTo(0,1); } </script>
	<link rel="stylesheet" href="//code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
	<script src="https://code.jquery.com/jquery-3.1.1.js"></script>
	<script src="js/skycons.js"></script>
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.8.3/modernizr.min.js"></script>
	<script>
	
	// device check (PC or mobile)  
  	var userAgentInfo = navigator.userAgent;
//	if(userAgentInfo.indexOf("Windows NT") >0){
//		window.location.replace("http://52.199.217.21");
//	}
	
	// Google Analytics
  	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  	ga('create', 'UA-90045865-1', 'auto');
  	ga('send', 'pageview');
	
	
	$(document).ready(function() {
	
		var mandarin_cht = new Array();
		var mandarin_twm = new Array();
		var mandarin_fet = new Array();
	
		var cht_contract = new Array();
		var twm_contract = new Array();
	
		// Hidden
		$("#damages_val").hide();
		$("#damages_tag").hide();	
		$("#damages_unit").hide();		
		$("#Contract_month").hide();	
		$("#Contract_name").hide();	
		$("#Contract_rate").hide();
	
		var start_date;
		//var end_date;
		var manually_date;
		var contract_length;
	
		// Fee
		var A_value;
		var B_value;
		var C_value;
		var total_day;	// contract total day
	
	if (!Modernizr.inputtypes.date) {	    
        $('#datepicker_1').datetimepicker({
            pickDate: true,
            pickTime: false
        });
        
		/*
		$('#datepicker_2').datetimepicker({
            pickDate: true,
            pickTime: false
        });
		*/
		
		$('#datepicker_3').datetimepicker({
            pickDate: true,
            pickTime: false
        });		    
     }
	
	/*
	// Contract length
	Create_Contract_length();
	function Create_Contract_length(){
		var selectList_comapy;
		selectList_comapy = "<select class='Contract_length'>";	
		selectList_comapy += "<option name='請選擇合約長度' value='"+0+"'>請選擇合約長度</option>"+"\n";
		selectList_comapy += "<option name='12個月' value='"+365+"'>12個月</option>"+"\n";
		selectList_comapy += "<option name='24個月' value='"+730+"'>24個月</option>"+"\n";
		selectList_comapy += "<option name='30個月' value='"+912+"'>30個月</option>"+"\n";
		selectList_comapy += "<option name='36個月' value='"+1095+"'>36個月</option>"+"\n";
		selectList_comapy += "</select>";
		$('#Contract_length').html(selectList_comapy);
	}
	*/
	
	// Subsidy
	$("#Subsidy").val("0");
	
	// Contract function	  // mandarin_cht	// cht_contract
	function node(name, value, contract_name, contract_value){
		this.name = name;
		this.value = value;
		this.contract_name = contract_name;
		this.contract_value = contract_value;
	}
	
	function contract(time_length_str, time_length_val, name){
		this.time_length_str = time_length_str;
		this.time_length_val = time_length_val;
		this.name = name;
	}
	
	function fee(name, index, fee, subsidy, preferential){
		this.name = name;
		this.index = index;
		this.fee = fee;		
		this.subsidy = subsidy;
		this.preferential = preferential;
	}
	
	function dataHierarchy(){
		
		// contract_name (CHT)
		var i=0;
		mandarin_cht[i++] = new contract("請選擇合約租期", 0, []);
		mandarin_cht[i++] = new contract("24個月", 24, ["請選擇合約方案", "大4G 金省方案 (7266)", "大4G 金鑽方案 (7267)", "大4G (新)優惠方案 (6890)", "4G平板大玩家方案 (6038)(24)", "4G智慧大玩家新方案 (6954)(24)", "4G學生優惠專案 (5327)(24)", "3G一般型資費方案 (5634)"]);
		mandarin_cht[i++] = new contract("30個月", 30, ["請選擇合約方案", "大4G 金省方案 (7266)", "大4G 金鑽方案 (7267)", "大4G 大七喜 (7251)", "大4G (新)優惠方案 (6891)", "4G平板大玩家方案 (6038)(30)", "4G學生優惠專案 (5408)", "4G學生優惠專案 (5327)(30)"]);
		mandarin_cht[i++] = new contract("36個月", 36, ["請選擇合約方案", "4G智慧大玩家新方案 (6954)(36)"])	
		// contract_value
		var j=0;		
		cht_contract[j++] = new fee("請選擇合約方案", 0, ["請選擇費率"],[],[]);								// A_value 				// B_value		// C_value = Subsidy
		cht_contract[j++] = new fee("大4G 金省方案 (7266)", 1, ["請選擇費率",398,598,798,998,1198],[0,3000,3000,4000,4000,4000],[0,1,1,1,1,1]);
		cht_contract[j++] = new fee("大4G 金鑽方案 (7267)", 2, ["請選擇費率",799,999,1399,1799,2699],[0,5500,7000,10000,10000,10000],[0,0,0,0,0,0]);
		cht_contract[j++] = new fee("大4G 大七喜 (7251)", 3, ["請選擇費率",777],[0,5000],[0,22]);
		cht_contract[j++] = new fee("大4G (新)優惠方案 (6890)", 4, ["請選擇費率",359,469,579,799,999,1199,1399,1799],[0,3000,3500,4000,4000,5000,6000,6000,6000],[0,40,130,20,0,0,0,0,0]);
		cht_contract[j++] = new fee("大4G (新)優惠方案 (6891)", 5, ["請選擇費率",359,469,579,799,999,1199,1399,1799],[0,5100,6700,8500,105000,13000,14800,18500,22500],[0,77,167,57,137,137,137,0,0]);
		cht_contract[j++] = new fee("3G一般型資費方案 (5634)", 6, ["請選擇費率",183,383,583,983,1683],[0,2000,6500,7300,8200,8400],[0,0,0,0,0,0]);
		cht_contract[j++] = new fee("4G平板大玩家方案 (6038)(24)", 7, ["請選擇費率",299,699,1199],[0,3700,6700,10700],[0,36,36,36]);
		cht_contract[j++] = new fee("4G平板大玩家方案 (6038)(30)", 8, ["請選擇費率",299,699,1199],[0,4000,8800,11300],[0,36,36,36]);
		cht_contract[j++] = new fee("4G智慧大玩家新方案 (6954)(24)", 9, ["請選擇費率",299,699,999,1199],[0,3300,7400,10800,12800],[0,100,100,0,0]);
		cht_contract[j++] = new fee("4G智慧大玩家新方案 (6954)(36)", 10, ["請選擇費率",299,699,999,1199],[0,4200,10700,14200,15800],[0,100,100,0,0]);	
		cht_contract[j++] = new fee("4G學生優惠專案 (5408)", 11, ["請選擇費率",587,787,987],[0,7000,8500,9500],[0,349,349,349]);
		cht_contract[j++] = new fee("4G學生優惠專案 (5327)(30)", 12, ["請選擇費率",687,887,1087],[0,6000,7500,9500],[0,249,249,249]);
		cht_contract[j++] = new fee("4G學生優惠專案 (5327)(24)", 13, ["請選擇費率",687,887,1087],[0,8000,9500,11000],[0,249,249,249]);
					// A_value = cht_contract[X].subsidy[]
						// cht_contract[X].fee[n];
						
		i=0;
		mandarin_twm[i++] = new contract("請選擇合約租期", 0, []);
		mandarin_twm[i++] = new contract("24個月", 24, ["請選擇合約方案","4G上網綁約優惠", "4G平板上網資費"]);
		mandarin_twm[i++] = new contract("30個月", 30, ["請選擇合約方案","4G上網綁約優惠"]);
		mandarin_twm[i++] = new contract("36個月", 36, ["請選擇合約方案","4G平板上網資費"]);
		j = 0;
		twm_contract[j++] = new fee("請選擇合約方案", 0, [],[],[]);
		twm_contract[j++] = new fee("4G上網綁約優", 1, [0,399,599,799,999,1199,1399,1599,1999,2699],[0,5000,7000,9500,11000,12500,15500,17000,20000,24900],[0,0,0,0,0,0,0,0,0,0]);
		
		
	
	
		// 電信公司
		var company = new Array();
		var i=0;
		company[i++] = new node("選擇電信商", 0, "null");			
		company[i++] = new node("中華電信", 1, mandarin_cht, cht_contract);			
		company[i++] = new node("台灣大哥大", 2, mandarin_twm, twm_contract);
		company[i++] = new node("遠傳電信", 3, mandarin_fet, cht_contract);
		
		return(company);
	}
	
	
	var comapy_num = dataHierarchy();	
	/*
	console.log(comapy_num.length);
	console.log(comapy_num[1]);
	console.log(comapy_num[1].value);
	//console.log(comapy_num[1].child);
	console.log(comapy_num[1].contract_name[0]);
	console.log(comapy_num[1].contract_name[0].name[0]);	
	console.log(comapy_num[1].contract_value[0]);
	console.log(comapy_num[1].contract_value[0].name);
	console.log(comapy_num[1].contract_value[3].name);
	*/
	
	// -----------------------------------------------------------------------
	var company_index;
	var contract_length_index;		var contract_totalday;
	var contract_name;
	var contract_rate;
	var contract_rate_index;
	// -----------------------------------------------------------------------
		
	// HTML
	// Add (Company)
	var selectList_comapy;
	selectList_comapy = "<select class='Select_Company'>";
	for (var i = 0; i < comapy_num.length; i++) 
	{
    	//<option name="12M" value="365">12 個月</option>
		selectList_comapy += "<option name='"+comapy_num[i].name +"' value='"+comapy_num[i].value+"'>"+comapy_num[i].name+"</option>"+"\n";
	}	
	selectList_comapy += "</select>";
	$('#Select_Company').html(selectList_comapy);
	
	// Add (Contract)(Month)
	// Null
	function Null_contract_month(){
		var contarct_null;
		contarct_null = "<select class='Contract_month'>";
		//for (var i = 0; i < mandarin_cht.length; i++) 
		{    	
			contarct_null += "<option name='"+mandarin_cht[0].time_length_str +"' value='"+mandarin_cht[0].time_length_val+"'>"+mandarin_cht[0].time_length_str+"</option>"+"\n";
		}	
		contarct_null += "</select>";
		$('#Contract_month').html(contarct_null);
	}
	// CHT
	function CHT_contract_month(){
		var contarct_cht;
		contarct_cht = "<select class='Contract_month'>";
		for (var i = 0; i < mandarin_cht.length; i++) 
		{    	
			contarct_cht += "<option name='"+mandarin_cht[i].time_length_str +"' value='"+mandarin_cht[i].time_length_val+"'>"+mandarin_cht[i].time_length_str+"</option>"+"\n";
		}	
		contarct_cht += "</select>";
		$('#Contract_month').html(contarct_cht);
	}	
	// TWM
	function TWM_contract_month(){
		var contarct_twm;
		contarct_twm = "<select class='Contract_month'>";
		for (var i = 0; i < mandarin_twm.length; i++) 
		{    	
			contarct_twm += "<option name='"+mandarin_twm[i].time_length_str +"' value='"+mandarin_twm[i].time_length_val+"'>"+mandarin_twm[i].time_length_str+"</option>"+"\n";
		}
		contarct_twm += "</select>";
		$('#Contract_month').html(contarct_twm);	
	}
	
	
	
	// Add (Contract)(Name)
	// Null	
	function Null_contract_name(){
		var contract_null;				
		contarct_null = "<select class='Contract_name'>";		
		contarct_null += "<option name='"+cht_contract[0].name+"' value='"+cht_contract[0].index+"'>"+cht_contract[0].name+"</option>"+"\n";	
		contarct_null += "</select>";
		$('#Contract_name').html(contarct_null);
	}
	
	
	// CHT
	function CHT_contract_name(length){
		var contract_cht;
		var temp_array = new Array();
		for(var i=0; i<mandarin_cht.length; i++)
		{
			if(mandarin_cht[i].time_length_val === length){
				temp_array = mandarin_cht[i].name;
			}
		}		
		
		contarct_cht = "<select class='Contract_name'>";
		for (var i=0; i<temp_array.length; i++) 
		{    	
			contarct_cht += "<option name='"+temp_array[i]+"' value='"+temp_array[i].index+"'>"+temp_array[i]+"</option>"+"\n";
		}	
		contarct_cht += "</select>";
		$('#Contract_name').html(contarct_cht);		
	}
	
	// TWM
	function TWM_contract_name(length){
		
	}
	
	// FET
	
	
	
	
	// Add (Contract)(Name)
	function Null_contract_rate(){
		var rate_null;				
		rate_null = "<select class='Contract_rate'>";		
		rate_null += "<option name='"+cht_contract[0].fee[0]+"' value='"+cht_contract[0].fee[0]+"'>"+cht_contract[0].fee[0]+"</option>"+"\n";	
		rate_null += "</select>";
		$('#Contract_rate').html(rate_null);
	}
	
	// CHT
	function CHT_contract_rate(){
		var rate_cht;				
		rate_cht = "<select class='Contract_rate'>";		
		var temp_array = new Array();
		for(var i=0; i<cht_contract.length; i++)
		{
			if(cht_contract[i].name === contract_name){
				temp_array = cht_contract[i].fee;
			}
		}
		//console.log(temp_array);
		rate_cht = "<select class='Contract_name'>";
		for (var i=0; i<temp_array.length; i++) 
		{    	
			rate_cht += "<option name='"+temp_array[i]+"' value='"+temp_array[i]+"'>"+temp_array[i]+"</option>"+"\n";
		}	
		rate_cht += "</select>";
		$('#Contract_rate').html(rate_cht);	
	}
		
	
	// ---------------------------------------------------------------------------------------------------------------

		// Telco Company (Create)
		var select_company_value;
		$("#Select_Company").change(function(){	
		select_company_value = $("#Select_Company option:selected" ).val();

	 	if(select_company_value === "0"){    		
			Null_contract_month();
			Null_contract_name();
			Null_contract_rate();
			$("#Contract_month").hide();
			$("#Contract_name").hide();
			$("#Contract_rate").hide();
  	 	}else if(select_company_value === "1"){
			if(manually_date == null){
				alert("須先設定欲解約日期");
			}
   			//console.log("中華電信");
			$('#Contract_month').html(mandarin_cht[0].time_length_str);
			company_index = 1;
			CHT_contract_month();
			Null_contract_name();
			Null_contract_rate();
			$("#Contract_month").show();
  	 	}else if(select_company_value === "2"){
			if(manually_date == null){
				alert("須先設定欲解約日期");
			}
   			//console.log("台灣大哥大");
			$('#Contract_month').html(mandarin_twm[0].time_length_str);
//			$('#Contract_name').html(twm_contract[0].name);
			company_index = 2;
			TWM_contract_month();
			Null_contract_name();
			Null_contract_rate();
			$("#Contract_month").show();
  	 	}else if($(this).val() === 3){
			if(manually_date == null){
				alert("須先設定欲解約日期");
			}
   			//console.log("遠傳電信");
			company_index = 3;
			
			Null_contract_name();
			Null_contract_rate();
			$("#Contract_month").show();
  	 	}	 
    	});
	
		// Contract month (Create)
		var select_contract_length;
		$("#Contract_month").change(function(){
		select_contract_length = $("#Contract_month option:selected" ).val();
		//console.log(select_contract_length);
			
		if(select_contract_length === "0"){
			//$('#Contract_name').html(cht_contract[0].name);
			Null_contract_name();
			$("#Contract_name").hide();
			$("#Contract_rate").hide();
		}else if(select_contract_length === "12"){
			contract_length_index = 12;
			contract_totalday = 365;
			Null_contract_name();
			Null_contract_rate();
			$("#Contract_name").show();
			switch(company_index)
			{
				case 1:					
					//CHT_contract_name(12);
				break;
				case 2:					
					//TWM_Contract_name(12);
				break;
				
				case 3:
				
				break;
			}			
		}else if(select_contract_length === "24"){
			contract_length_index = 24;
			contract_totalday = 730;
			Null_contract_name();
			Null_contract_rate();
			$("#Contract_name").show();
			switch(company_index)
			{
				case 1:										
					CHT_contract_name(24);
					//console.log(comapy_num[company_index].contract_name[1].time_length_val)  == contract_length_index
				break;
				case 2:					
					TWM_contract_name(24);
				break;				
				case 3:
				
				break;
			}
		}else if(select_contract_length === "30"){
			contract_length_index = 30;
			contract_totalday = 912;
			Null_contract_name();
			Null_contract_rate();
			$("#Contract_name").show();
			switch(company_index)
			{
				case 1:										
					CHT_contract_name(30);					
				break;
				case 2:					
					TWM_contract_name(30);
				break;				
				case 3:
				
				break;
			}
		}else if(select_contract_length === "36"){
			contract_length_index = 36;
			contract_totalday = 1095;
			Null_contract_name();
			Null_contract_rate();
			$("#Contract_name").show();
			switch(company_index)
			{
				case 1:										
					CHT_contract_name(36);
				break;
				case 2:					
					TWM_contract_name(36);
				break;				
				case 3:
				
				break;
			}
		}
		
		});
	
		// Contract rate (Create)
		$("#Contract_name").change(function(){			
			contract_name = $("#Contract_name option:selected").text();
			
			if(contract_name === "0"){
				Null_contract_rate();			
				$("#Contract_rate").hide();
			}else{
				//console.log(contract_name);
				$("#Contract_rate").show();
				switch(company_index)
				{
					case 1:					
						CHT_contract_rate();
					break;
					case 2:					
									
					break;				
					case 3:
				
					break;
				}	
			}				
		});
		

		// Star date
		$("#datepicker_1").change(function(){
			start_date = document.getElementById('datepicker_1').value;		
			//$('.Contract_length').val('0');
		});
		
		// End date
/*		
		$("#datepicker_2").change(function(){
			end_date = document.getElementById('datepicker_2').value;		
		});
*/		
		/*
		// Contract length 
		$("#Contract_length").change(function(){			
			
			if(start_date != null){
				contract_length = $("#Contract_length option:selected" ).val();	
				//console.log(contract_length);				
				var d_parts = start_date.split('-');				
				var end_date = new Date(d_parts[0],d_parts[1]-1,d_parts[2]);
				end_date.setDate(end_date.getDate()+ parseInt(contract_length));		
				//console.log(start_date+"	"+new_date);				
			}else{
				alert("須設定合約起始日期");
			}			
		});
		*/
		
		// Manually_date		
		$("#datepicker_3").change(function(){
			if(start_date == null){
				alert("須先設定合約起始日期");				
				$('#datepicker_3').val("");
			}
			manually_date = document.getElementById('datepicker_3').value;
			var date_gap_M = DateDifference(start_date, manually_date);			
			if(date_gap_M <= 0){
				alert("欲解約日期不得早於合約起始日期");
				$('#datepicker_3').val("");				
			}
		});
		
		
		// Day gap
		function DateDifference(StartDate, EndDate)
		{
   			var myStartDate = new Date(StartDate);
   			var myEndDate = new Date(EndDate);
   		
     		return (myEndDate - myStartDate)/86400000 ;
		}	
		
		//  Contract rate (Change) --> Calculator
		$("#Contract_rate").change(function(){
			contract_rate = $("#Contract_rate option:selected").text();			
			contract_rate_index = $("#Contract_rate option:selected").index();			
			if(start_date == null){
				alert("須設定合約起始日期");
			}
			//if(end_date == null){
			//	alert("須設定合約結束日期");
			//}
			if(manually_date == null){
				alert("須設定欲解約日期");
			}
			if((start_date!=null)&&(manually_date!=null)){
				//console.log("Ya");					
				//console.log(contract_rate);
				//contract_length_index	 長度 (12,24,30,36)
				//contract_name			 名稱
				//contract_rate			 費率
				
				//console.log(comapy_num[company_index].contract_name[1].time_length_val
				//console.log(comapy_num[1].contract_value[3].name);
				Get_AllValue();				
				Calculator();
			}				
		});
		
		function Get_AllValue(){
			for(var i=0;i<comapy_num[company_index].contract_value.length;i++)
			{
				if(comapy_num[company_index].contract_value[i].name === contract_name){
					A_value = comapy_num[company_index].contract_value[i].subsidy[contract_rate_index];
					B_value = comapy_num[company_index].contract_value[i].preferential[contract_rate_index];
					C_value = $("#Subsidy").val();
					total_day = contract_totalday;
					console.log(A_value+"	"+B_value+"	"+C_value+"	"+total_day);
					//console.log(comapy_num[company_index].contract_value[i].fee[contract_rate_index]);
					// var today_end;
					//var end_manually;
					
					break;
				}
			}
		}
		
		// Calculator
		function Calculator()
		{
			//[((36/30) * (730-240))+6700+1000] * (224/730) = NT 2543
			//var temp  = ((B_value / 30) * (total_day - today_end)) + parseFloat(A_value) + parseFloat(C_value);
			//var demages = temp * (end_manually / total_day);
		}		
	
});
	
    </script>
    <style type="text/css">	
	.style2 {
		color: #FF0000;
		font-size: xx-large;
	}
	</style>
    
</head>
<body>
<h1>門號解約金計算機</h1>
<div class="main-agileits">
	<div class="sign-in-wthree">
		<div class="sign-in-top-agileinfo">			
			<p>讓大家了解自己的手機門號在合約尚未到期時若想進行解約時所需要繳交的解約金是多少, 可藉由此計算機來幫助計算</p>
	  </div>
		<div class="sign-in-bottom-agileinfo">
			<form action="#" method="post">
				<table width="100%" border="1">
                  <tr>
                    <td><h3>門號起始日期</h3></td>
                    <td><input type="date" id="datepicker_1"></td>
                  </tr>                  
                  <tr>
                    <td><h3>欲解約日期</h3></td>
                    <td><input type="date" id="datepicker_3"></td>
                  </tr>                               
                  <tr>
                    <td><h3>電信公司</h3></td>
                    <td id="Select_Company" width="auto">                    
                    </td>
                  </tr>
                  <tr>
                    <td><h3>原合約長度</h3></td>
                    <td id="Contract_month" width="auto">              
                    </td>
                  </tr> 
                  <tr>
                    <td><h3>原合約名稱</h3></td>
                    <td id="Contract_name" width="auto">              
                    </td>
                  </tr> 
                  <tr>
                    <td><h3>月租費</h3></td>
                    <td id="Contract_rate" width="auto">              
                    </td>
                  </tr>
                  <tr>
                    <td><h3>專案補貼款(手機/平板)</h3></td>
                    <td width="auto"><input id="Subsidy"></td>
                  </tr>
                  <tr>
                    <td><h3><label id='damages_tag'>違約金總計為</label></h3></td>
                    <td width="auto"><label class="style2" id='damages_val'>$</label>&nbsp;<label id='damages_unit'>元</label>
                    </td>
                  </tr> 
                  <tr>
                    <td>&nbsp;</td>
                    <td>&nbsp;</td>
                  </tr>
                </table>
				<h3>&nbsp;</h3>
			</form>
		</div>
	</div>
	</div>
<div class="footer-agileits-w3layouts">
	<p class="agileinfo">&nbsp;</p>
</div>
</body>
</html>